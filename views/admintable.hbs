<!DOCTYPE html>
<html>

<head>
  <title>Dynamic Table Example</title>
 
<script lang="javascript" src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    
    th {
      background-color: #f2f2f2;
    }
    .button-wrapper {
      text-align: right;
      margin-top: 20px;
    }
    
    .button-wrapper button {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: #ffffff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    
    .button-wrapper button:hover {
      background-color: #45a049;
    }
  </style>
</head>

<body>
  <h1>Dynamic Table Example</h1>
  
  <div class="button-wrapper">
    <button id="export" onclick="fnExportToExcel('xlsx','myfirstsheet')">Export</button>
  </div>

  <table id="export-table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Company</th>
        <th>Owner</th>
        <th>Item</th>
        <th>Count</th>
        <th>Weight</th>
        <th>Request for Shipment</th>
      </tr>
    </thead>
    <tbody>
      {{#each data}}
        <tr>
          <td>{{date}}</td>
          <td>{{company}}</td>
          <td>{{owner}}</td>
          <td>{{item}}</td>
          <td>{{count}}</td>
          <td>{{weight}}</td>
          <td>{{requestforshipment}}</td>
        </tr>
      {{/each}}
    </tbody>
  </table>
  <script >
    function fnExportToExcel(fileExtension,fileName) {
      var el = document.getElementById('export-table')
      var wb = XLSX.utils.table_to_book(el,{sheet:'sheet1'})
      return XLSX.writeFile(wb,fileName+"."+fileExtension || ('MySheetName.'+(fileExtension||'xlsx')))
    }
   </script>
</body>

</html>
